<!DOCTYPE html>
<html>
   <head>
      <meta charset='utf-8' />
      <title>GEOG 186 Final Project - Draft, Zack Dinh</title>
      <link rel="stylesheet" href="main_2.css">
      <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
      <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.js'></script>
      <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.css' rel='stylesheet' />
   </head>
   <body>
    <p> </p>
       
       <h2 style="text-align:center;">Modeling traffic-related black carbon emissions at the Port of Oakland from movement data</h2>
       
       <h4 style="text-align:center;">Zack Dinh | Sam Fernandes | Rebecca Sugrue | Dajie Sun</h4>
       
       <p>Traffic-related emissions related to diesel activity from maritime vessels and ground vehicles originating from the Port of Oakland is harmful to the environment and health of neighboring communities. In this project we analyzed activity at the Port from movement data and modeled the black carbon emissions of this activity using vehicle and engine characteristics. We belive this method provides valuable and independent monitoring capability. The map below presents a composite of the the available vehicle activity at the Port for one month (vessels: June 2017, ground vehicles: January 2019).</p>
    <p> </p>
        <img src="https://66.media.tumblr.com/65c218846899b6ec5cd9b9a408198303/tumblr_pquehg5AC01rxl92fo1_1280.png">

    <p> </p>
       <h3 style="text-align:center;">Vessel and ground vehicle movement activity at the Port of Oakland</h3>
      <style>
         #menu {
         background: #fff;
         position: absolute;
         z-index: 1;
         top: 420px;
         right: 60px;
         border-radius: 3px;
         width: 170px;
         border: 1px solid rgba(0,0,0,0.4);
         font-family: 'Open Sans', sans-serif;
         }
         #menu a {
         font-size: 12px;
         color: #000000;
         display: block;
         margin: 0;
         padding: 0;
         padding: 10px;
         text-decoration: none;
         border-bottom: 1px solid rgba(0,0,0,0.25);
         text-align: center;
         }
         #menu a:last-child {
         border: none;
         }
         #menu a:hover {
         background-color: #f8f8f8;
         color: #404040;
         }
         #menu a.active {
         background-color: #ffffff;
         color: #000000;
         }
         #menu a.active:hover {
         background: #808080;
         }
      </style>
        <nav id="menu"></nav>
        <div id="map" style= "width: 100%; height: 700px"></div>
      <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiemFja2RpbmgiLCJhIjoiY2p0ZGoxMjc2MTd0azQzbW9zNWUzbm1meCJ9.wVLjaWeqoQ235YTL4n_CwQ';
         var map = new mapboxgl.Map({
             container: 'map',
             style: 'mapbox://styles/zackdinh/cjuivuq5h6q151fqimglnrs8l',
             center: [-122.313, 37.809],
         zoom: 13,
         });
          
        map.addControl(new mapboxgl.ScaleControl({position: 'bottom-right'}));
        map.addControl(new mapboxgl.NavigationControl());
        map.addControl(new mapboxgl.FullscreenControl());
         
        map.on('load', function() {
         
             map.addSource('Desktop-61i1ve', {
                 type: 'vector',
                 url: 'mapbox://zackdinh.52kum2r5'
             });
             

             
             map.addSource('bins-cobv08', {
                 type: 'vector',
                 url: 'mapbox://zackdinh.d10c483w'
             });
             
             map.addLayer({
         'id': 'Bins',
         'type': 'line',
         'source': 'bins-cobv08',
         'source-layer': 'bins-cobv08',
         'layout': {
         'visibility': 'none',
         'line-join': 'round',
         'line-cap': 'round'
         },
         'paint': {
         'line-color': '#86bde4',
         'line-width': .25
         }
         });


           map.on('click', 'Vessel Tracks', function (e) {
         new mapboxgl.Popup()
         .setLngLat(e.lngLat)
         .setHTML(e.features[0].properties.VesselName)
         .addTo(map);
         });
         
         // Change the cursor to a pointer when the mouse is over the states layer.
         map.on('mouseenter', 'Vessel Tracks', function () {
         map.getCanvas().style.cursor = 'pointer';
         });
         
         // Change it back to a pointer when it leaves.
         map.on('mouseleave', 'Vessel Tracks', function () {
         map.getCanvas().style.cursor = '';
         });
             
            map.on('click', 'Vessel Berthing Locations', function (e) {
         new mapboxgl.Popup()
         .setLngLat(e.lngLat)
         .setHTML(e.features[0].properties.VesselName)
         .addTo(map);
         });
         
         // Change the cursor to a pointer when the mouse is over the states layer.
         map.on('mouseenter', 'Vessel Berthing Locations', function () {
         map.getCanvas().style.cursor = 'pointer';
         });
         
         // Change it back to a pointer when it leaves.
         map.on('mouseleave', 'Vessel Berthing Locations', function () {
         map.getCanvas().style.cursor = '';
         });
         });
          
          var toggleableLayerIds = ['Port Entrances', 'Vessel Tracks', 'Ground Vehicle Tracks', 'Vessel Points', 'Ground Vehicle Points', 'Bins'
                                   ];
         
         for (var i = 0; i < toggleableLayerIds.length; i++) {
         var id = toggleableLayerIds[i];
         
         var link = document.createElement('a');
         link.href = '#';
         link.className = 'active';
         link.textContent = id;
         
         link.onclick = function (e) {
         var clickedLayer = this.textContent;
         e.preventDefault();
         e.stopPropagation();
         
         var visibility = map.getLayoutProperty(clickedLayer, 'visibility');
         
         if (visibility === 'visible') {
         map.setLayoutProperty(clickedLayer, 'visibility', 'none');
         this.className = '';
         } else {
         this.className = 'active';
         map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
         }
         };
         
         var layers = document.getElementById('menu');
         layers.appendChild(link);
         }
      </script>
      <!--<img src="https://www.mercurynews.com/wp-content/uploads/2016/08/20121211_095601_Economy-Trade-Deficit.jpg">-->
      <!--<h5>Container ships berthed at the Port of Oakland.</h5>-->
        <p> </p>
        <h3 style="text-align:center;">Vessel Movement Data: 80,850 data points, 119 unique vessels</h3>
       <p>Vessel activity was derived from Automatic Identification System (AIS) data. A system used internationally, primarily to prevent vessel collisions. AIS is required for all vessels greater than 300 gross tonnes. Each AIS message contains: MMSI (vessel identifier), BaseDateTime (date and time), LAT (UTM latitude), LON (UTM longitude), along with vessel type, heading, speed and other useful information.</p>
           
           <p>We first developed a method to decode raw AIS messages using the Python package libais, and evaluated the decoder using a sample of raw AIS data. We then downloaded a full AIS dataset from the US Coast Guard for June 2017 for UTM zone 10. This data set contained 34,187,287 AIS messages, totalling 3.9GB. From this dataset we extracted AIS messages located within the study area, yielding 559,596 AIS messages, totalling 87MB. Further subsetting of AIS messages was then performed by selecting only cargo and tanker vessel type classifications (Vessel Type - Cargo: 1003, 1004, 1016, Vessel Type - Tanker: 1017, 1024). Our final AIS dataset for June 2017 in the study area is 80,850 AIS messages, totalling 11MB.</p>

        <p>We identified 119 unique vessels based on MMSI (Maritime Mobile Service Identity) identifiers: 117 Cargo (1004) vessels, 1 Cargo (1003) vessel, and 1 Cargo (1016) vessel. For each vessel we have generated: polyline tracks (Figure 5), speed, total time the vessel was present at the Port of Oakland, total time the vessel was berthed, and total time the vessel was maneuvering. Cumulatively, the 119 vessels operated for a total of 3,497.8 hours at the Port of Oakland. 156.6 hours was classified as maneuvering (4%), and 3,341.2 hours classified as berthed (96%). We obtained additional vessel characteristics for 108 vessels found in the Marine Traffic database, providing us with vessel dimensions, tonnage, cargo capacity, year built, owner, and builder information.</p>
       
       <p >Vessel movement data: <a href="https://marinecadastre.gov/ais/"> MarineCadastre.gov</a></p>
 
        <!--<img src="https://www.ttnews.com/sites/default/files/port-of-los-angeles-1200.jpg">-->
      <!--<h5>Freight trucking activity at the Port of Oakland.</h5>-->
    

       <h3 style="text-align:center;">Ground Vehicle Movement Data</h3>
       <p>Ground vehicle probe data was provided by Dr. Jane McFarlane for the month of January 2019 (January 1-30). The data lied within the study area illustrated in Figure 1. Data was not cleaned prior to access and represented all commercial and fleet activity in the study area. Time was converted to PST local time. Data included the following columns: Probe ID, Sample Date (original), Latitude(degrees), Longitude (degrees), Heading (degrees), Speed (kmph), Probe Provider (Fleet # or Commercial #), X (UTM latitude), Y(UTM longitude), and Local Time (PST).</p>
       
       <p>Ground vehicle movement data: Courtesy of Dr. Jane McFarlane, College of Civil & Environmental Engineering</p>
       
        <h3 style="text-align:center;">Results</h3>
       
       
       <p>Port information: <a href="https://www.portofoakland.com/"> Port of Oakland.</a></p>
       
       <p style="text-align:center;">CE 263 N Scalable Spatial Analytics | GEOG 186 Web Cartogrpahy</p>
       <p style="text-align:center;">University of California, Berkeley</p>
       
       
       
       
   </body>
</html>
